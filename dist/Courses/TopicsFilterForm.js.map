{"version":3,"file":"TopicsFilterForm.js","names":["React","Component","ApiHelper","t","Select","TopicsFilterForm","_Component","_inherits","_super","_createSuper","props","_this","_classCallCheck","call","_defineProperty","_assertThisInitialized","resourceType","concat","searchSubject","api","origin","params","callback","response","options","mapArrayToSelectOptions","topics","setState","fetchResource","_ref","topic","_this$props$topics","updateQueryParams","_toConsumableArray","filter","topicArray","Object","keys","sort","map","value","label","state","_createClass","key","componentDidMount","fetchTopics","render","_this2","_this$props$topics2","option","indexOf","topicDisplay","slug","display","length","createElement","Fragment","className","htmlFor","name","inputId","isMulti","handleChange","onChange","placeholder","_templateObject","_taggedTemplateLiteral","role","onClick","e","removeTopic","default"],"sources":["../../src/Courses/TopicsFilterForm.jsx"],"sourcesContent":["import React, { Component } from 'react'\nimport ApiHelper from '../utils/apiHelper'\nimport { t } from 'ttag'\nimport Select from '../InputFields/Select';\n\n\nexport default class TopicsFilterForm extends Component {\n  constructor(props) {\n    super(props)\n    this.state = { options: [] }\n  }\n\n  componentDidMount() {\n    this.fetchTopics();\n  }\n\n  fetchTopics = () => {\n    const resourceType = `${this.props.searchSubject}Topics`;\n    const api = new ApiHelper(resourceType, this.props.origin);\n    const params = {};\n    const callback = (response) => {\n      const options = this.mapArrayToSelectOptions(response.topics);\n      this.setState({ options })\n    }\n\n    api.fetchResource({ params, callback })\n  }\n\n  onChange = ({topic}) => {\n    let {topics = []} = this.props;\n    if (topic) {\n      this.props.updateQueryParams({topics: [...topics, topic]});\n    }\n  }\n\n  removeTopic = (topic) => {\n    this.props.updateQueryParams({topics: this.props.topics.filter(t => t != topic)});\n  }\n\n  mapArrayToSelectOptions = (topics) => {\n    const topicArray = Object.keys(topics).sort()\n    return topicArray.map((topic) => ({ value: topic, label: topics[topic] }))\n  }\n\n  render() {\n    let {topics = []} = this.props;\n    let options = this.state.options.filter( option => topics.indexOf(option.value) == -1);\n\n    const topicDisplay = slug => {\n      const display = this.state.options.filter(option => slug == option.value);\n      if (display.length == 1)\n        return display[0].label;\n      return slug;\n    };\n\n    return(\n      <>\n        <form className=\"filter\">\n          <label htmlFor=\"topic-input\" className=\"form-label\">Topics</label>\n          <Select\n            name={'topic'}\n            inputId=\"topic-input\"\n            options={options}\n            isMulti={false}\n            value={null}\n            handleChange={this.onChange}\n            placeholder={t`Select topic(s)`}\n          />\n          { \n            this.props.topics && <div className=\"badges selected pt-2\">\n              { \n                this.props.topics && topics.map(topic => \n                  <span key={`${topic}-badge`} className=\"badge topic-selected topic\">\n                    <span className=\"material-icons dismiss\" role=\"button\" onClick={e => this.removeTopic(topic)}>close</span>{topicDisplay(topic)}</span>\n                )\n              }\n            </div>\n          }\n        </form>\n      </>\n    )\n  }\n}\n"],"mappings":"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"}