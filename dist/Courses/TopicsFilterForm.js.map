{"version":3,"file":"TopicsFilterForm.js","names":["React","Component","ApiHelper","t","Select","TopicsFilterForm","props","resourceType","searchSubject","api","origin","params","callback","response","options","mapArrayToSelectOptions","topics","setState","fetchResource","topic","updateQueryParams","filter","topicArray","Object","keys","sort","map","value","label","state","fetchTopics","option","indexOf","topicDisplay","slug","display","length","onChange","e","removeTopic"],"sources":["../../src/Courses/TopicsFilterForm.jsx"],"sourcesContent":["import React, { Component } from 'react'\nimport ApiHelper from '../utils/apiHelper'\nimport { t } from 'ttag'\nimport Select from '../InputFields/Select';\n\n\nexport default class TopicsFilterForm extends Component {\n  constructor(props) {\n    super(props)\n    this.state = { options: [] }\n  }\n\n  componentDidMount() {\n    this.fetchTopics();\n  }\n\n  fetchTopics = () => {\n    const resourceType = `${this.props.searchSubject}Topics`;\n    const api = new ApiHelper(resourceType, this.props.origin);\n    const params = {};\n    const callback = (response) => {\n      const options = this.mapArrayToSelectOptions(response.topics);\n      this.setState({ options })\n    }\n\n    api.fetchResource({ params, callback })\n  }\n\n  onChange = ({topic}) => {\n    let {topics = []} = this.props;\n    if (topic) {\n      this.props.updateQueryParams({topics: [...topics, topic]});\n    }\n  }\n\n  removeTopic = (topic) => {\n    this.props.updateQueryParams({topics: this.props.topics.filter(t => t != topic)});\n  }\n\n  mapArrayToSelectOptions = (topics) => {\n    const topicArray = Object.keys(topics).sort()\n    return topicArray.map((topic) => ({ value: topic, label: topics[topic] }))\n  }\n\n  render() {\n    let {topics = []} = this.props;\n    let options = this.state.options.filter( option => topics.indexOf(option.value) == -1);\n\n    const topicDisplay = slug => {\n      const display = this.state.options.filter(option => slug == option.value);\n      if (display.length == 1)\n        return display[0].label;\n      return slug;\n    };\n\n    return(\n      <>\n        <form className=\"filter\">\n          <label htmlFor=\"topic-input\" className=\"form-label\">Topics</label>\n          <Select\n            name={'topic'}\n            inputId=\"topic-input\"\n            options={options}\n            isMulti={false}\n            value={null}\n            handleChange={this.onChange}\n            placeholder={t`Select topic(s)`}\n          />\n          { \n            this.props.topics && <div className=\"badges selected pt-2\">\n              { \n                this.props.topics && topics.map(topic => \n                  <span key={`${topic}-badge`} className=\"badge topic-selected topic\">\n                    <span className=\"material-icons dismiss\" role=\"button\" onClick={e => this.removeTopic(topic)}>close</span>{topicDisplay(topic)}</span>\n                )\n              }\n            </div>\n          }\n        </form>\n      </>\n    )\n  }\n}\n"],"mappings":";;;;;;;;;;;;AAAA,OAAOA,KAAK,IAAIC,SAAS,QAAQ,OAAO;AACxC,OAAOC,SAAS,MAAM,oBAAoB;AAC1C,SAASC,CAAC,QAAQ,MAAM;AACxB,OAAOC,MAAM,MAAM,uBAAuB;AAAC,IAGtBC,gBAAgB;EAAA;EAAA;EACnC,0BAAYC,KAAK,EAAE;IAAA;IAAA;IACjB,0BAAMA,KAAK;IAAC,8DAQA,YAAM;MAClB,IAAMC,YAAY,aAAM,MAAKD,KAAK,CAACE,aAAa,WAAQ;MACxD,IAAMC,GAAG,GAAG,IAAIP,SAAS,CAACK,YAAY,EAAE,MAAKD,KAAK,CAACI,MAAM,CAAC;MAC1D,IAAMC,MAAM,GAAG,CAAC,CAAC;MACjB,IAAMC,QAAQ,GAAG,SAAXA,QAAQ,CAAIC,QAAQ,EAAK;QAC7B,IAAMC,OAAO,GAAG,MAAKC,uBAAuB,CAACF,QAAQ,CAACG,MAAM,CAAC;QAC7D,MAAKC,QAAQ,CAAC;UAAEH,OAAO,EAAPA;QAAQ,CAAC,CAAC;MAC5B,CAAC;MAEDL,GAAG,CAACS,aAAa,CAAC;QAAEP,MAAM,EAANA,MAAM;QAAEC,QAAQ,EAARA;MAAS,CAAC,CAAC;IACzC,CAAC;IAAA,2DAEU,gBAAa;MAAA,IAAXO,KAAK,QAALA,KAAK;MAChB,yBAAoB,MAAKb,KAAK,CAAzBU,MAAM;QAANA,MAAM,mCAAG,EAAE;MAChB,IAAIG,KAAK,EAAE;QACT,MAAKb,KAAK,CAACc,iBAAiB,CAAC;UAACJ,MAAM,+BAAMA,MAAM,IAAEG,KAAK;QAAC,CAAC,CAAC;MAC5D;IACF,CAAC;IAAA,8DAEa,UAACA,KAAK,EAAK;MACvB,MAAKb,KAAK,CAACc,iBAAiB,CAAC;QAACJ,MAAM,EAAE,MAAKV,KAAK,CAACU,MAAM,CAACK,MAAM,CAAC,UAAAlB,CAAC;UAAA,OAAIA,CAAC,IAAIgB,KAAK;QAAA;MAAC,CAAC,CAAC;IACnF,CAAC;IAAA,0EAEyB,UAACH,MAAM,EAAK;MACpC,IAAMM,UAAU,GAAGC,MAAM,CAACC,IAAI,CAACR,MAAM,CAAC,CAACS,IAAI,EAAE;MAC7C,OAAOH,UAAU,CAACI,GAAG,CAAC,UAACP,KAAK;QAAA,OAAM;UAAEQ,KAAK,EAAER,KAAK;UAAES,KAAK,EAAEZ,MAAM,CAACG,KAAK;QAAE,CAAC;MAAA,CAAC,CAAC;IAC5E,CAAC;IAjCC,MAAKU,KAAK,GAAG;MAAEf,OAAO,EAAE;IAAG,CAAC;IAAA;EAC9B;EAAC;IAAA;IAAA,OAED,6BAAoB;MAClB,IAAI,CAACgB,WAAW,EAAE;IACpB;EAAC;IAAA;IAAA,OA8BD,kBAAS;MAAA;MACP,0BAAoB,IAAI,CAACxB,KAAK,CAAzBU,MAAM;QAANA,MAAM,oCAAG,EAAE;MAChB,IAAIF,OAAO,GAAG,IAAI,CAACe,KAAK,CAACf,OAAO,CAACO,MAAM,CAAE,UAAAU,MAAM;QAAA,OAAIf,MAAM,CAACgB,OAAO,CAACD,MAAM,CAACJ,KAAK,CAAC,IAAI,CAAC,CAAC;MAAA,EAAC;MAEtF,IAAMM,YAAY,GAAG,SAAfA,YAAY,CAAGC,IAAI,EAAI;QAC3B,IAAMC,OAAO,GAAG,MAAI,CAACN,KAAK,CAACf,OAAO,CAACO,MAAM,CAAC,UAAAU,MAAM;UAAA,OAAIG,IAAI,IAAIH,MAAM,CAACJ,KAAK;QAAA,EAAC;QACzE,IAAIQ,OAAO,CAACC,MAAM,IAAI,CAAC,EACrB,OAAOD,OAAO,CAAC,CAAC,CAAC,CAACP,KAAK;QACzB,OAAOM,IAAI;MACb,CAAC;MAED,oBACE,uDACE;QAAM,SAAS,EAAC;MAAQ,gBACtB;QAAO,OAAO,EAAC,aAAa;QAAC,SAAS,EAAC;MAAY,GAAC,QAAM,CAAQ,eAClE,oBAAC,MAAM;QACL,IAAI,EAAE,OAAQ;QACd,OAAO,EAAC,aAAa;QACrB,OAAO,EAAEpB,OAAQ;QACjB,OAAO,EAAE,KAAM;QACf,KAAK,EAAE,IAAK;QACZ,YAAY,EAAE,IAAI,CAACuB,QAAS;QAC5B,WAAW,EAAElC,CAAC;MAAkB,EAChC,EAEA,IAAI,CAACG,KAAK,CAACU,MAAM,iBAAI;QAAK,SAAS,EAAC;MAAsB,GAEtD,IAAI,CAACV,KAAK,CAACU,MAAM,IAAIA,MAAM,CAACU,GAAG,CAAC,UAAAP,KAAK;QAAA,oBACnC;UAAM,GAAG,YAAKA,KAAK,WAAS;UAAC,SAAS,EAAC;QAA4B,gBACjE;UAAM,SAAS,EAAC,wBAAwB;UAAC,IAAI,EAAC,QAAQ;UAAC,OAAO,EAAE,iBAAAmB,CAAC;YAAA,OAAI,MAAI,CAACC,WAAW,CAACpB,KAAK,CAAC;UAAA;QAAC,GAAC,OAAK,CAAO,EAACc,YAAY,CAACd,KAAK,CAAC,CAAQ;MAAA,EACzI,CAEC,CAEH,CACN;IAEP;EAAC;EAAA;AAAA,EA3E2ClB,SAAS;AAAA,SAAlCI,gBAAgB"}