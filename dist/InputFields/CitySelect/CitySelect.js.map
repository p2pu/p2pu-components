{"version":3,"sources":["../../../src/InputFields/CitySelect/CitySelect.js"],"names":["React","useState","useEffect","PropTypes","Select","jsonp","InputWrapper","CitySelectInput","props","cities","setCities","url","err","res","console","log","items","cities_","filter","city","uniqBy","arr","fn","Map","map","x","values","el","value","onChange","selected","query","label","handleChange","name","getSelected","isMulti","v","find","id","disabled","required","errorMessage","classes","selectClasses","handleInputChange","noResultsText","placeholder","isClearable","rest","customStyles","indicatorSeparator","provided","state","display","CitySelect","helpText","propTypes","func","isRequired","string","bool","defaultProps"],"mappings":";;;;;;;;;;;;AAAA,OAAOA,KAAP,IAAgBC,QAAhB,EAA0BC,SAA1B,QAA2C,OAA3C;AACA,OAAOC,SAAP,MAAsB,YAAtB;AACA,OAAOC,MAAP,MAAmB,cAAnB;AACA,OAAOC,KAAP,MAAkB,OAAlB;AAEA,OAAOC,YAAP,MAAyB,iBAAzB;AAGA,OAAO,IAAMC,eAAe,GAAG,SAAlBA,eAAkB,CAAAC,KAAK,EAAI;AACtC,kBAA4BP,QAAQ,CAAC,EAAD,CAApC;AAAA;AAAA,MAAOQ,MAAP;AAAA,MAAeC,SAAf;;AAEAR,EAAAA,SAAS,CAAC,YAAM;AACd,QAAMS,GAAG,GAAG,8DAAZ;AACAN,IAAAA,KAAK,CAACM,GAAD,EAAM,IAAN,EAAY,UAACC,GAAD,EAAMC,GAAN,EAAc;AAC7B,UAAID,GAAJ,EAAS;AACPE,QAAAA,OAAO,CAACC,GAAR,CAAYH,GAAZ;AACD,OAFD,MAEO;AACL,YAAIC,GAAG,CAACG,KAAR,EAAe;AACb,cAAIC,OAAO,GAAGJ,GAAG,CAACG,KAAJ,CAAUE,MAAV,CAAkB,UAAAC,IAAI;AAAA,mBAAIA,IAAJ;AAAA,WAAtB,CAAd;;AACA,cAAMC,MAAM,GAAG,SAATA,MAAS,CAACC,GAAD,EAAMC,EAAN;AAAA,sCAAiB,IAAIC,GAAJ,CAAQF,GAAG,CAACG,GAAJ,CAAQ,UAACC,CAAD;AAAA,qBAAO,CAAC,OAAOH,EAAP,KAAc,UAAd,GAA2BA,EAAE,CAACG,CAAD,CAA7B,GAAmCA,CAAC,CAACH,EAAD,CAArC,EAA2CG,CAA3C,CAAP;AAAA,aAAR,CAAR,EAAuEC,MAAvE,EAAjB;AAAA,WAAf;;AACAT,UAAAA,OAAO,GAAGG,MAAM,CAACH,OAAD,EAAU,UAAAU,EAAE;AAAA,mBAAIA,EAAE,CAACC,KAAP;AAAA,WAAZ,CAAhB;AACAlB,UAAAA,SAAS,CAACO,OAAD,CAAT;AACD,SALD,MAKO;AACLH,UAAAA,OAAO,CAACC,GAAR,CAAYF,GAAZ;AACD;AACF;AACF,KAbI,CAAL;AAcD,GAhBQ,EAgBN,EAhBM,CAAT;;AAmBA,MAAMgB,QAAQ,GAAG,SAAXA,QAAW,CAACC,QAAD,EAAc;AAC7B,QAAMC,KAAK,GAAGD,QAAQ,GAAGA,QAAQ,CAACE,KAAZ,GAAoBF,QAA1C;AACAtB,IAAAA,KAAK,CAACyB,YAAN,qBAAsBzB,KAAK,CAAC0B,IAA5B,EAAmCH,KAAnC;AACD,GAHD;;AAKA,MAAMI,WAAW,GAAG,SAAdA,WAAc,CAAAP,KAAK,EAAI;AAC3B,QAAQQ,OAAR,GAAoB5B,KAApB,CAAQ4B,OAAR;;AACA,QAAI,CAACR,KAAL,EAAY;AACV,aAAO,IAAP;AACD;;AAED,QAAIQ,OAAO,YAAWR,KAAK,KAAK,QAArB,CAAX,EAA2C;AACzC,aAAOA,KAAK,CAACJ,GAAN,CAAU,UAAAa,CAAC;AAAA,eAAI5B,MAAM,CAAC6B,IAAP,CAAY,UAAAnB,IAAI;AAAA,iBAAIA,IAAI,CAACa,KAAL,KAAeK,CAAnB;AAAA,SAAhB,CAAJ;AAAA,OAAX,CAAP;AACD;;AAED,WAAO5B,MAAM,CAAC6B,IAAP,CAAY,UAAAnB,IAAI;AAAA,aAAIA,IAAI,CAACa,KAAL,KAAeJ,KAAnB;AAAA,KAAhB,CAAP;AACD,GAXD;;AAaA,MACEM,IADF,GAII1B,KAJJ,CACE0B,IADF;AAAA,MACQK,EADR,GAII/B,KAJJ,CACQ+B,EADR;AAAA,MACYX,KADZ,GAIIpB,KAJJ,CACYoB,KADZ;AAAA,MACmBY,QADnB,GAIIhC,KAJJ,CACmBgC,QADnB;AAAA,MAC6BC,QAD7B,GAIIjC,KAJJ,CAC6BiC,QAD7B;AAAA,MACuCC,YADvC,GAIIlC,KAJJ,CACuCkC,YADvC;AAAA,MAEEC,OAFF,GAIInC,KAJJ,CAEEmC,OAFF;AAAA,MAEWC,aAFX,GAIIpC,KAJJ,CAEWoC,aAFX;AAAA,MAE0BC,iBAF1B,GAIIrC,KAJJ,CAE0BqC,iBAF1B;AAAA,MAE6CC,aAF7C,GAIItC,KAJJ,CAE6CsC,aAF7C;AAAA,MAGEC,WAHF,GAIIvC,KAJJ,CAGEuC,WAHF;AAAA,MAGeC,WAHf,GAIIxC,KAJJ,CAGewC,WAHf;AAAA,MAG4BZ,OAH5B,GAII5B,KAJJ,CAG4B4B,OAH5B;AAAA,MAGwCa,IAHxC,4BAIIzC,KAJJ;;AAMA,MAAMsB,QAAQ,GAAGK,WAAW,CAACP,KAAD,CAA5B;AAEA,MAAMsB,YAAY,GAAG;AACnBC,IAAAA,kBAAkB,EAAE,4BAACC,QAAD,EAAWC,KAAX;AAAA,6CACfD,QADe;AAElBE,QAAAA,OAAO,EAAE;AAFS;AAAA;AADD,GAArB;AAOA,sBACE,oBAAC,MAAD;AACE,IAAA,IAAI,EAAGpB,IADT;AAEE,IAAA,SAAS,wBAAkBU,aAAlB,CAFX;AAGE,IAAA,KAAK,EAAGd,QAHV;AAIE,IAAA,OAAO,EAAGrB,MAJZ;AAKE,IAAA,QAAQ,EAAGoB,QALb;AAME,IAAA,aAAa,EAAGgB,iBANlB;AAOE,IAAA,aAAa,EAAGC,aAPlB;AAQE,IAAA,WAAW,EAAGC,WARhB;AASE,IAAA,WAAW,EAAGC,WAThB;AAUE,IAAA,OAAO,EAAGZ,OAVZ;AAWE,IAAA,UAAU,EAAGI,QAXf;AAYE,IAAA,eAAe,EAAE,aAZnB;AAaE,IAAA,MAAM,EAAEU;AAbV,KAcMD,IAdN,EADF;AAkBD,CAzEM;;AA6EP,IAAMM,UAAU,GAAG,SAAbA,UAAa,CAAA/C,KAAK,EAAI;AAC1B,MACEwB,KADF,GAEIxB,KAFJ,CACEwB,KADF;AAAA,MACSE,IADT,GAEI1B,KAFJ,CACS0B,IADT;AAAA,MACeK,EADf,GAEI/B,KAFJ,CACe+B,EADf;AAAA,MACmBC,QADnB,GAEIhC,KAFJ,CACmBgC,QADnB;AAAA,MAC6BC,QAD7B,GAEIjC,KAFJ,CAC6BiC,QAD7B;AAAA,MACuCC,YADvC,GAEIlC,KAFJ,CACuCkC,YADvC;AAAA,MACqDc,QADrD,GAEIhD,KAFJ,CACqDgD,QADrD;AAAA,MAC+Db,OAD/D,GAEInC,KAFJ,CAC+DmC,OAD/D;AAIA,sBACE,oBAAC,YAAD;AACE,IAAA,KAAK,EAAEX,KADT;AAEE,IAAA,IAAI,EAAEE,IAFR;AAGE,IAAA,EAAE,EAAEK,EAHN;AAIE,IAAA,QAAQ,EAAEE,QAJZ;AAKE,IAAA,QAAQ,EAAED,QALZ;AAME,IAAA,YAAY,EAAEE,YANhB;AAOE,IAAA,QAAQ,EAAEc,QAPZ;AAQE,IAAA,OAAO,EAAEb;AARX,kBAUE,oBAAC,eAAD,EAAqBnC,KAArB,CAVF,CADF;AAeD,CApBD;;AAsBA+C,UAAU,CAACE,SAAX,GAAuB;AACrBxB,EAAAA,YAAY,EAAE9B,SAAS,CAACuD,IAAV,CAAeC,UADR;AAErBzB,EAAAA,IAAI,EAAE/B,SAAS,CAACyD,MAAV,CAAiBD,UAFF;AAGrB/B,EAAAA,KAAK,EAAEzB,SAAS,CAACyD,MAHI;AAIrBf,EAAAA,iBAAiB,EAAE1C,SAAS,CAACuD,IAJR;AAKrBf,EAAAA,OAAO,EAAExC,SAAS,CAACyD,MALE;AAMrBd,EAAAA,aAAa,EAAE3C,SAAS,CAACyD,MANJ;AAOrBb,EAAAA,WAAW,EAAE5C,SAAS,CAACyD,MAPF;AAQrBJ,EAAAA,QAAQ,EAAErD,SAAS,CAACyD,MARC;AASrBlB,EAAAA,YAAY,EAAEvC,SAAS,CAACyD,MATH;AAUrBZ,EAAAA,WAAW,EAAE7C,SAAS,CAAC0D,IAVF;AAWrBzB,EAAAA,OAAO,EAAEjC,SAAS,CAAC0D;AAXE,CAAvB;AAcAN,UAAU,CAACO,YAAX,GAA0B;AACxBhB,EAAAA,aAAa,EAAE,0BADS;AAExBC,EAAAA,WAAW,EAAE,6BAFW;AAGxBJ,EAAAA,OAAO,EAAE,EAHe;AAIxBT,EAAAA,IAAI,EAAE,aAJkB;AAKxBD,EAAAA,YAAY,EAAE,sBAACH,QAAD;AAAA,WAAchB,OAAO,CAACC,GAAR,CAAY,wCAAZ,EAAsDe,QAAtD,CAAd;AAAA,GALU;AAMxBkB,EAAAA,WAAW,EAAE,IANW;AAOxBZ,EAAAA,OAAO,EAAE,KAPe;AAQxBR,EAAAA,KAAK,EAAE;AARiB,CAA1B;AAWA,eAAe2B,UAAf","sourcesContent":["import React, { useState, useEffect } from 'react'\nimport PropTypes from 'prop-types'\nimport Select from 'react-select'\nimport jsonp from 'jsonp'\n\nimport InputWrapper from '../InputWrapper'\n\n\nexport const CitySelectInput = props => {\n  const [cities, setCities] = useState([])\n\n  useEffect(() => {\n    const url = 'https://learningcircles.p2pu.org/api/learningcircles/cities/'\n    jsonp(url, null, (err, res) => {\n      if (err) {\n        console.log(err)\n      } else {\n        if (res.items) {\n          let cities_ = res.items.filter( city => city );\n          const uniqBy = (arr, fn) => [...new Map(arr.map((x) => [typeof fn === 'function' ? fn(x) : x[fn], x])).values()]\n          cities_ = uniqBy(cities_, el => el.value);\n          setCities(cities_);\n        } else {\n          console.log(res)\n        }\n      }\n    });\n  }, [])\n\n\n  const onChange = (selected) => {\n    const query = selected ? selected.label : selected;\n    props.handleChange({ [props.name]: query })\n  }\n\n  const getSelected = value => {\n    const { isMulti } = props;\n    if (!value) {\n      return null\n    }\n\n    if (isMulti && typeof(value === 'object')) {\n      return value.map(v => cities.find(city => city.label === v))\n    }\n\n    return cities.find(city => city.label === value)\n  }\n\n  const { \n    name, id, value, disabled, required, errorMessage,\n    classes, selectClasses, handleInputChange, noResultsText,\n    placeholder, isClearable, isMulti, ...rest \n  } = props;\n\n  const selected = getSelected(value);\n\n  const customStyles = {\n    indicatorSeparator: (provided, state) => ({\n      ...provided,\n      display: 'none',\n    }),\n  }\n\n  return(\n    <Select\n      name={ name }\n      className={ `city-select ${selectClasses}` }\n      value={ selected }\n      options={ cities }\n      onChange={ onChange }\n      onInputChange={ handleInputChange }\n      noResultsText={ noResultsText }\n      placeholder={ placeholder }\n      isClearable={ isClearable }\n      isMulti={ isMulti }\n      isDisabled={ disabled }\n      classNamePrefix={'city-select'}\n      styles={customStyles}\n      {...rest}\n    />\n  )\n}\n\n\n\nconst CitySelect = props => {\n  const { \n    label, name, id, disabled, required, errorMessage, helpText, classes \n  } = props;\n\n  return(\n    <InputWrapper\n      label={label}\n      name={name}\n      id={id}\n      required={required}\n      disabled={disabled}\n      errorMessage={errorMessage}\n      helpText={helpText}\n      classes={classes}\n    >\n      <CitySelectInput {...props} />\n    </InputWrapper>\n  )\n\n}\n\nCitySelect.propTypes = {\n  handleChange: PropTypes.func.isRequired,\n  name: PropTypes.string.isRequired,\n  value: PropTypes.string,\n  handleInputChange: PropTypes.func,\n  classes: PropTypes.string,\n  noResultsText: PropTypes.string,\n  placeholder: PropTypes.string,\n  helpText: PropTypes.string,\n  errorMessage: PropTypes.string,\n  isClearable: PropTypes.bool,\n  isMulti: PropTypes.bool,\n}\n\nCitySelect.defaultProps = {\n  noResultsText: \"No results for this city\",\n  placeholder: \"Start typing a city name...\",\n  classes: \"\",\n  name: \"select-city\",\n  handleChange: (selected) => console.log(\"Implement a function to save selection\", selected),\n  isClearable: true,\n  isMulti: false,\n  value: null,\n}\n\nexport default CitySelect\n"],"file":"CitySelect.js"}